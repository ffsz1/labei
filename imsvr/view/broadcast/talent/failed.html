<style>
    .right-content{
        padding-top:54px!important; padding-left:0!important; width:970px!important;
    }
</style>
<div class="content">
    <% include ../leftBar.html %>
    <!-- right content start -->
    <div class="right-content myTalents-approved myTalents-rejected">
        <div class="pageInfo">My talents</div>
        <div id="tabs-container">
            <% include topBar.html %>

            <div class="tab">
                <div id="tab-1" class="tab-content">
                    <div class="subject">
                        <ul class="">
                            <li style="width: 190px;">Name</li>
                            <li style="width: 74px; text-align: center; margin-left:20px; margin-right: 20px;">Type</li>
                            <li style="width: 100px; text-align: center; margin-right: 30px;">Price (coin)</li>
                            <li style="width: 400px;">Description</li>
                        </ul>
                    </div>

                    <%if(data.length){%>
                    <div class="list">
                        <%for(let val of data){%>
                        <ul id="<%=val.id%>" class="talent">
                            <li style="width: 190px; padding:0px;">
                                <table border="0" cellspacing="0" cellpadding="0">
                                    <tr>
                                        <td style="max-width: 190px; word-break:keep-all; overflow: hidden;"><%=val.talent_name%></td>
                                    </tr>
                                </table>
                            </li>
                            <li style="width: 74px; margin-left:20px; margin-right: 20px; padding:0px;">
                                <table border="0" cellspacing="0" cellpadding="0">
                                    <tr>
                                        <td style="width: 74px; text-align: center;  word-break:keep-all;"><%=val.type%></td>
                                    </tr>
                                </table>
                            </li>
                            <li style="width: 100px; text-align: center; margin-right: 30px; padding:0px;">
                                <table border="0" cellspacing="0" cellpadding="0">
                                    <tr>
                                        <td style="width: 100px; text-align: center; word-break:break-all;"><%=val.credit%></td>
                                    </tr>
                                </table>
                            </li>
                            <li style="width: 400px; padding:0px;">
                                <table border="0" cellspacing="0" cellpadding="0">
                                    <tr>
                                        <td style="max-width: 400px; word-break:keep-all; overflow: hidden;"><%=val.talent_desc%></td>
                                    </tr>
                                </table>
                            </li>
                            <li>
                                <ul>
                                    <li><a href="javascript:;"><img src="<%=public_path%>/img/moveUp-icon.png" width="30" height="30" alt=""/></a></li>
                                    <li><a class="disable" href="javascript:;"><img src="<%=public_path%>/img/moveDown-icon.png" width="30" height="30" alt=""/></a></li>
                                    <li><a class="talentsDelete" href="javascript:;"><img src="<%=public_path%>/img/delete-icon.png" width="30" height="30" alt=""/></a></li>
                                </ul>
                            </li>
                        </ul>
                        <%}%>
                    </div>
                    <%}else{%>
                    <div class="empty">No talents set. </div>
                    <%}%>
                </div>
            </div>
        </div>
        <div id="page" class="pagenation"></div>
    </div>
    <!-- right content end -->
</div>

<script>
    $(function(){

        /**
         * 删除才能
         */
        $('.talentsDelete').on('click', function(){
            let id = $(this).parents('ul.talent').attr('id');
            parent.layer.confirm('Are you sure you wish to delete this item?', {
                btn:['Cancel', 'Yes'],
                title:'',
                btnAlign:'c',
                closeBtn: 0,
                shadeClose:true,
                shade:0.01
            }, function(){
                parent.layer.msg('Cancel Delete');
            }, function(){
                $.post('/broadcast/talent/deleteTalent',{id:id},function(data){
                    if(data.errno == 0){
                        $('#'+id).remove();
                        parent.layer.msg('deleted');
                    }else{
                        parent.layer.msg('Failed to delete');
                    }
                })
            });
        })

        //分页
        var pages = Math.ceil('<%=count.total%>'/'<%=step%>');
        if(pages>1) {
            page('page', pages);
        }
    })
</script>
