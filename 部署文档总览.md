# 拉贝星球项目部署文档总览

> **项目名称：** 拉贝星球（语音社交/直播平台）  
> **文档生成时间：** 2025-11-10  
> **文档版本：** v1.0

---

## 📚 文档清单

本项目提供了完整的部署文档和自动化脚本，确保您能够**100% 1:1 复刻**源码环境。

### 📄 主要文档

| 文档名称 | 文件路径 | 用途说明 |
|---------|---------|---------|
| **部署文档总览** | `部署文档总览.md` | 📍 当前文档，快速导航 |
| **1:1搭建部署方案** | `拉贝星球项目1比1搭建部署方案.md` | 📖 完整的部署指南（300+页） |
| **分步执行方案** | `拉贝星球项目1比1搭建分步执行方案（精准落地版）.md` | ✅ 精准落地的分步执行方案 |
| **源码目录分析报告** | `项目源码目录分析报告.md` | 🔍 源码结构和功能分析 |

### 🛠️ 自动化脚本

| 脚本名称 | 文件路径 | 平台 | 功能说明 |
|---------|---------|------|---------|
| **环境检查脚本** | `scripts/check-env.bat` | Windows | 检查所有依赖是否安装 |
| **环境检查脚本** | `scripts/check-env.sh` | Linux | 检查所有依赖是否安装 |
| **一键部署脚本** | `scripts/deploy-all.bat` | Windows | 自动部署所有服务 |
| **一键部署脚本** | `scripts/deploy-all.sh` | Linux | 自动部署所有服务 |
| **API测试脚本** | `scripts/test-api.bat` | Windows | 测试API接口功能 |
| **配置参数文件** | `scripts/config-params.txt` | 通用 | 集中管理配置参数 |
| **脚本使用说明** | `scripts/README.md` | 通用 | 脚本详细使用说明 |

---

## 🚀 快速开始（3步部署）

### 第1步：检查环境

```bash
# Windows
cd C:\Users\优酪时光\Desktop\labei\scripts
check-env.bat

# Linux
cd /path/to/labei/scripts
chmod +x *.sh
./check-env.sh
```

**✅ 确保所有依赖检查通过！**

---

### 第2步：修改配置

编辑 `scripts/config-params.txt` 文件：

```ini
# 必须修改的参数
MYSQL_PASSWORD=你的MySQL密码
REDIS_PASSWORD=你的Redis密码
SERVER_DOMAIN=http://你的域名

# 可选参数（第三方服务）
QINIU_ACCESS_KEY=你的七牛云AccessKey
AGORA_APP_ID=你的声网AppID
...
```

---

### 第3步：一键部署

```bash
# Windows
deploy-all.bat

# Linux
./deploy-all.sh
```

**⏱️ 等待约 30-60 分钟完成部署**

---

## 📖 详细文档说明

### 1️⃣ 拉贝星球项目1比1搭建部署方案.md

**适用场景：** 首次部署、完整学习、生产环境部署

**内容概览：**
- ✅ 完整的环境要求和安装步骤（Windows + Linux）
- ✅ 数据库配置和初始化
- ✅ 后端服务（adminbak + apiservice）部署
- ✅ IM服务器（imsvr）部署
- ✅ H5前端部署
- ✅ Nginx 配置
- ✅ 性能优化建议
- ✅ 安全加固方案
- ✅ 监控和日志配置
- ✅ 备份和恢复策略

**页数：** 约 300 页

**推荐阅读顺序：**
1. 环境要求 → 基础环境安装
2. 数据库配置 → 后端服务搭建
3. IM服务器搭建 → H5前端部署
4. 配置文件详解 → 启动顺序
5. 常见问题 → 附录（性能优化、安全加固等）

---

### 2️⃣ 拉贝星球项目1比1搭建分步执行方案（精准落地版）.md

**适用场景：** 精准执行、零偏差部署、验证清单

**内容概览：**

#### 阶段1: 环境准备
- ✅ 依赖清单核对（精确版本号）
- ✅ 目录结构复刻（完全一致）
- ✅ 配置文件预处理（批量替换）

#### 阶段2: 源码部署
- ✅ 数据库部署与验证（50+张表）
- ✅ 后端服务部署与验证（5个JAR文件）
- ✅ IM服务器部署与验证（3个进程）
- ✅ 前端H5部署与验证

#### 阶段3: 匹配度验证
- ✅ 目录结构1:1校验
- ✅ 功能完整性测试（核心流程）
- ✅ 一键脚本复用性测试

**特点：**
- 每个步骤都有验证清单 ☑️
- 所有命令都可直接执行
- 包含详细的错误处理

---

### 3️⃣ 项目源码目录分析报告.md

**适用场景：** 了解项目结构、技术栈、功能模块

**内容概览：**
- 📁 adminbak 目录分析（旧版Spring MVC）
- 📁 apiservice 目录分析（新版Spring Boot）
- 📁 imsvr 目录分析（Node.js IM服务器）
- 📁 h5 目录分析（H5前端页面）
- 🏗️ 系统架构图
- 📊 数据流向图
- 🔧 技术栈对比

---

## 🎯 推荐使用流程

### 场景1：首次部署（推荐新手）

```
1. 阅读《部署文档总览》（当前文档）
   ↓
2. 阅读《项目源码目录分析报告》了解项目结构
   ↓
3. 按照《1:1搭建部署方案》逐步安装环境
   ↓
4. 使用 check-env 脚本验证环境
   ↓
5. 按照《分步执行方案》逐步部署
   ↓
6. 使用 test-api 脚本验证功能
```

---

### 场景2：快速部署（推荐有经验者）

```
1. 使用 check-env 脚本检查环境
   ↓
2. 修改 config-params.txt 配置参数
   ↓
3. 运行 deploy-all 脚本一键部署
   ↓
4. 使用 test-api 脚本验证功能
   ↓
5. 遇到问题查阅《1:1搭建部署方案》
```

---

### 场景3：生产环境部署

```
1. 阅读《1:1搭建部署方案》完整文档
   ↓
2. 按照附录E进行性能优化
   ↓
3. 按照附录G进行安全加固
   ↓
4. 配置附录F的监控和日志
   ↓
5. 设置附录H的备份策略
   ↓
6. 使用《分步执行方案》的验证清单全面测试
```

---

## 📊 项目技术栈总览

### 后端技术栈

| 模块 | 框架 | 版本 | 构建工具 |
|------|------|------|---------|
| **adminbak** | Spring MVC | 4.1.0.RELEASE | Maven |
| **apiservice** | Spring Boot | 2.0.1.RELEASE | Maven |
| **imsvr** | Koa + Socket.io | 2.3.0 | npm |

### 数据库

| 类型 | 版本 | 用途 |
|------|------|------|
| **MySQL** | 5.7+ | 主数据库 |
| **Redis** | 3.2+ | 缓存 |
| **MongoDB** | 4.0+ | IM消息存储 |

### 前端技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| **Vue.js** | 2.6.11 | H5框架 |
| **Vant** | 2.8 | UI组件库 |
| **Axios** | 最新 | HTTP客户端 |

---

## ✅ 部署验证清单

### 环境准备阶段
- [ ] JDK 1.8 安装并验证
- [ ] Maven 3.5+ 安装并验证
- [ ] Node.js 8.x-12.x 安装并验证
- [ ] MySQL 5.7 安装并验证
- [ ] Redis 3.2+ 安装并验证
- [ ] MongoDB 4.0+ 安装并验证
- [ ] ActiveMQ 5.15+ 安装并验证
- [ ] PM2 安装并验证

### 源码部署阶段
- [ ] 数据库创建成功（labei + yingtao）
- [ ] 数据库表导入成功（50+张表）
- [ ] apiservice 编译成功（5个JAR文件）
- [ ] imsvr 依赖安装成功
- [ ] API 服务启动成功（端口 8080）
- [ ] IM 服务启动成功（3个进程）
- [ ] Nginx 启动成功（端口 80）

### 功能验证阶段
- [ ] 访问 http://localhost:8080/swagger-ui.html 正常
- [ ] 访问 http://localhost 显示H5页面
- [ ] 用户登录接口正常
- [ ] 房间列表接口正常
- [ ] 礼物列表接口正常
- [ ] IM 实时通信正常

---

## 🔧 常见问题快速索引

| 问题类型 | 查看文档 | 章节 |
|---------|---------|------|
| Maven 编译失败 | 《1:1搭建部署方案》 | 常见问题 #1 |
| 数据库连接失败 | 《1:1搭建部署方案》 | 常见问题 #2 |
| Redis 连接失败 | 《1:1搭建部署方案》 | 常见问题 #3 |
| IM 服务器启动失败 | 《1:1搭建部署方案》 | 常见问题 #4 |
| Nginx 403 错误 | 《1:1搭建部署方案》 | 常见问题 #5 |
| 跨域问题 | 《1:1搭建部署方案》 | 常见问题 #6 |
| 内存不足 | 《1:1搭建部署方案》 | 常见问题 #7 |

---

## 📞 技术支持

### 文档查阅顺序

1. **快速问题** → 查看《部署文档总览》常见问题索引
2. **详细步骤** → 查看《分步执行方案》对应章节
3. **深入理解** → 查看《1:1搭建部署方案》完整文档
4. **项目结构** → 查看《源码目录分析报告》

### 日志文件位置

```
# API 服务日志
apiservice/xchat-web-api/logs/

# IM 服务日志
~/.pm2/logs/

# Nginx 日志
/var/log/nginx/  (Linux)
C:\nginx\logs\   (Windows)
```

---

## 🎉 部署成功标志

当您看到以下内容时，说明部署成功：

### 1. 服务运行状态

```bash
# Windows
tasklist | findstr java        # 应显示 API 服务进程
pm2 list                       # 应显示 3 个 IM 进程
tasklist | findstr nginx       # 应显示 Nginx 进程

# Linux
ps aux | grep appservice       # 应显示 API 服务进程
pm2 list                       # 应显示 3 个 IM 进程
systemctl status nginx         # 应显示 Nginx 运行中
```

### 2. 访问测试

- ✅ http://localhost:8080/swagger-ui.html - Swagger API 文档
- ✅ http://localhost:8080/actuator/health - 健康检查（返回 UP）
- ✅ http://localhost:3001 - IM HTTP 服务
- ✅ http://localhost - H5 首页

### 3. 功能测试

- ✅ 用户登录功能正常
- ✅ 房间列表显示正常
- ✅ 礼物列表显示正常
- ✅ IM 实时通信正常

---

## 📈 下一步建议

部署成功后，建议进行以下优化：

1. **性能优化** - 参考《1:1搭建部署方案》附录E
2. **安全加固** - 参考《1:1搭建部署方案》附录G
3. **监控配置** - 参考《1:1搭建部署方案》附录F
4. **备份策略** - 参考《1:1搭建部署方案》附录H
5. **域名配置** - 配置正式域名和SSL证书
6. **CDN加速** - 配置静态资源CDN

---

## 📝 文档更新记录

| 版本 | 日期 | 更新内容 |
|------|------|---------|
| v1.0 | 2025-11-10 | 初始版本，包含完整部署文档和脚本 |

---

**祝您部署顺利！** 🎉

如有任何问题，请查阅相应文档或检查日志文件。

