<style>
    .bar1, .bar2 {
        margin-bottom: 10px;
    }

    label.col-sm-1 {
        padding: 0;
        line-height: 30px;
        text-align: right;
        /*padding-right: 4px;*/
    }

    label.col-sm-1 {
        padding: 0;
        line-height: 30px;
        text-align: right;
        /*padding-right: 4px;*/
    }

    input, select {
        margin-left: 8px;
        margin-right: 8px;
    }

    #btnSearch {
        margin-left: 36px;
    }

    .record {
        margin-top: 10px;
    }

    .record .title {
        font-size: 16px;
    }
</style>
<section class="content">
    <div class="box box-primary">
        <div class="box-body">
            <section class="content-header">
                <h1 id="itemTitle"></h1>
            </section>
            <section class="content">
                <div id="table"></div>
                <div id="toolbar">
                    <label for="phone" class="col-sm-1 control-label">手机号:</label>
                    <div class="col-sm-3">
                        <input type="text" class="form-control validate[required]" name="phone" id="phone">
                    </div>
                    <label for="erbanNo" class="col-sm-1 control-label">拉贝号:</label>
                    <div class="col-sm-3">
                        <input type="text" class="form-control validate[required]" name="erbanNo" id="erbanNo">
                    </div>
                    <label class="col-sm-1 control-label">查询类型:</label>
                    <div class="col-sm-2">
                        <select name="type" id="type" class="input-m form-control">
                            <option value="0">---全部---</option>
                            <option value="1">微信登录</option>
                            <option value="2">qq登录</option>
                        </select>
                    </div>
                    <div class="col-sm-1">
                        <button id="btnSearch" class="btn btn-primary">
                            <i class="glyphicon glyphicon-search"></i> 查询
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </div>
</section>
<script>
    $(function () {
        $('#table').bootstrapTable('destroy');
        $('#table').bootstrapTable({
            columns: [
                {field: 'recordId', title: 'recordId', align: 'center', valign: 'middle', width: '10%', visible: false},
                {field: 'erbanNo', title: '拉贝号', align: 'center', valign: 'middle', width: '150'},
                {field: 'phone', title: '手机号码', align: 'center', valign: 'middle', width: '150'},
                {
                    field: 'loginType',
                    title: '登录类型',
                    align: 'center',
                    width: '150',
                    valign: 'middle',
                    formatter: function (val) {
                        switch (val) {
                            case 1:
                                return '微信登录';
                            case 2:
                                return 'QQ登录';
                            case 3:
                                return '手机登录或者拉贝号登录';
                        }
                    }
                },
                {field: 'loginIp', title: '登录IP', align: 'center', width: '200', valign: 'middle'},
                {
                    field: 'createTime',
                    title: '登录时间',
                    align: 'center',
                    width: '250',
                    valign: 'middle',
                    formatter: function (val) {
                        if (val) {
                            const date = new Date(val);
                            return date.format("yyyy-MM-dd HH:mm:ss");
                        } else {
                            return '-';
                        }
                    }
                },
                {field: 'weixinOpenid', title: '微信 OpenId', align: 'center', width: '200', valign: 'middle'},
                {field: 'qqOpenid', title: 'QQ OpenId', align: 'center', width: '200', valign: 'middle'},
                {field: 'model', title: '手机型号', align: 'center', width: '150', valign: 'middle'},
                {field: 'os', title: '系统类型', align: 'center', width: '150',  valign: 'middle'},
                {field: 'osversion', title: '系统版本', align: 'center', width: '150', valign: 'middle'},
                {field: 'ispType', title: '运营商类型', align: 'center', width: '150', valign: 'middle'},
                {field: 'deviceId', title: '设备号', align: 'center', width: '200', valign: 'middle'},
                {field: 'appVersion', title: 'App版本', align: 'center', width: '150', valign: 'middle'}
                // {
                //     field: 'tmp',
                //     title: '操作',
                //     align: 'center',
                //     width: '20%',
                //     valign: 'middle',
                //     formatter: function (val, row, index) {
                //         var key = row.blockId;
                //         return "<button class='btn btn-sm btn-success opt-release'  data-id=" + key + ">解封</button>&nbsp;&nbsp;"+
                //                 "<button class='btn btn-sm btn-success opt-edit'  data-id=" + key + " >编辑</button>";
                //     }
                // }
            ],
            cache: false,
            striped: true,
            showRefresh: false,
            pageSize: 10,
            pagination: true,
            pageList: [10, 20, 30, 50],
            sidePagination: "server",
            queryParamsType: "undefined",
            queryParams: function queryParams(params) {
                const param = {
                    pageSize: params.pageSize,
                    pageNum: params.pageNumber,
                    phone: $('#phone').val(),
                    erbanNo: $('#erbanNo').val(),
                    loginType: $('#type').val()
                };
                return param;
            },
            uniqueId: 'code',
            toolbar: '#toolbar',
            url: '/admin/accountLoginRecord/list.action',
            onLoadSuccess: function () {
                console.log("load success");
            },
            onLoadError: function () {
                console.log("load fail");
            }
        });
    });

    // 查询刷新
    $('#btnSearch').on('click', function () {
        TableHelper.doRefresh('#table');
    });
</script>
