<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.erban.main.mybatismapper.NobleUsersMapperMgr" >
  <resultMap id="BaseResultMap" type="com.erban.main.model.NobleUsers" >
    <id column="uid" property="uid" jdbcType="BIGINT" />
    <result column="noble_id" property="nobleId" jdbcType="INTEGER" />
    <result column="noble_name" property="nobleName" jdbcType="VARCHAR" />
    <result column="expire" property="expire" jdbcType="TIMESTAMP" />
    <result column="badge" property="badge" jdbcType="VARCHAR" />
    <result column="cardbg" property="cardbg" jdbcType="VARCHAR" />
    <result column="zonebg" property="zonebg" jdbcType="VARCHAR" />
    <result column="room_background" property="roomBackground" jdbcType="VARCHAR" />
    <result column="mic_decorate" property="micDecorate" jdbcType="VARCHAR" />
    <result column="chat_bubble" property="chatBubble" jdbcType="VARCHAR" />
    <result column="mic_halo" property="micHalo" jdbcType="VARCHAR" />
    <result column="enter_hide" property="enterHide" jdbcType="TINYINT" />
    <result column="rank_hide" property="rankHide" jdbcType="TINYINT" />
    <result column="good_num" property="goodNum" jdbcType="BIGINT" />
    <result column="recom_count" property="recomCount" jdbcType="TINYINT" />
    <result column="status" property="status" jdbcType="TINYINT" />
    <result column="open_time" property="openTime" jdbcType="TIMESTAMP" />
    <result column="renew_time" property="renewTime" jdbcType="TIMESTAMP" />
  </resultMap>

  <update id="updateRenewNobleUsers" >
    update noble_users set expire=#{0}, renew_time=NOW(), recom_count=recom_count+#{1} where uid=#{2}
  </update>

  <update id="reduceRecomCount" >
    update noble_users set recom_count=recom_count-1 where uid=#{1} and recom_count>0
  </update>
</mapper>
