# 拉贝星球项目 - 完整部署文档包

> **项目名称：** 拉贝星球（语音社交/直播平台）  
> **文档生成时间：** 2025-11-10  
> **文档版本：** v1.0  
> **适用场景：** 从零开始 100% 1:1 复刻部署

---

## 🎯 快速开始（3步部署）

### 第1步：检查环境

```bash
# Windows
cd scripts
check-env.bat

# Linux
cd scripts
chmod +x *.sh
./check-env.sh
```

### 第2步：修改配置

编辑 `scripts/config-params.txt`，修改数据库密码和域名。

### 第3步：一键部署

```bash
# Windows
scripts\deploy-all.bat

# Linux
scripts/deploy-all.sh
```

**⏱️ 预计耗时：30-60 分钟**

---

## 📚 文档清单

### 📖 主要文档（5份）

| 序号 | 文档名称 | 大小 | 用途说明 |
|------|---------|------|---------|
| 1 | **部署文档总览.md** | 9.6 KB | 📍 快速导航，推荐首先阅读 |
| 2 | **部署执行检查清单.md** | 9.9 KB | ✅ 逐项检查清单，确保每步完成 |
| 3 | **拉贝星球项目1比1搭建分步执行方案（精准落地版）.md** | 30.9 KB | 🎯 精准落地方案，分步执行 |
| 4 | **拉贝星球项目1比1搭建部署方案.md** | 43.1 KB | 📖 完整部署指南（300+页） |
| 5 | **项目源码目录分析报告.md** | 26.0 KB | 🔍 源码结构和功能分析 |

**总计：** 119.5 KB，约 400 页内容

### 🛠️ 自动化脚本（7个）

| 序号 | 脚本名称 | 大小 | 平台 | 功能说明 |
|------|---------|------|------|---------|
| 1 | **check-env.bat** | 2.2 KB | Windows | 检查环境依赖 |
| 2 | **check-env.sh** | 2.3 KB | Linux | 检查环境依赖 |
| 3 | **deploy-all.bat** | 2.8 KB | Windows | 一键部署所有服务 |
| 4 | **deploy-all.sh** | 3.0 KB | Linux | 一键部署所有服务 |
| 5 | **test-api.bat** | 1.4 KB | Windows | 测试API接口 |
| 6 | **config-params.txt** | 1.0 KB | 通用 | 配置参数文件 |
| 7 | **scripts/README.md** | 2.8 KB | 通用 | 脚本使用说明 |

**总计：** 15.5 KB

---

## 📂 项目结构

```
C:/Users/优酪时光/Desktop/labei/
├── 📄 README.md                                          # 本文档
├── 📄 部署文档总览.md                                     # 快速导航
├── 📄 部署执行检查清单.md                                 # 检查清单
├── 📄 拉贝星球项目1比1搭建分步执行方案（精准落地版）.md    # 分步方案
├── 📄 拉贝星球项目1比1搭建部署方案.md                     # 完整指南
├── 📄 项目源码目录分析报告.md                             # 源码分析
├── 📁 scripts/                                           # 自动化脚本
│   ├── check-env.bat                                    # Windows环境检查
│   ├── check-env.sh                                     # Linux环境检查
│   ├── deploy-all.bat                                   # Windows一键部署
│   ├── deploy-all.sh                                    # Linux一键部署
│   ├── test-api.bat                                     # API测试脚本
│   ├── config-params.txt                                # 配置参数
│   └── README.md                                        # 脚本说明
├── 📁 adminbak/                                          # 旧版Spring MVC后台
├── 📁 apiservice/                                        # 新版Spring Boot服务
├── 📁 imsvr/                                             # Node.js IM服务器
├── 📁 h5/                                                # H5前端页面
└── 📄 labei.sql                                          # 数据库脚本
```

---

## 🎓 推荐阅读顺序

### 场景1：首次部署（新手推荐）

```
1. README.md（本文档）
   ↓
2. 部署文档总览.md
   ↓
3. 项目源码目录分析报告.md
   ↓
4. 拉贝星球项目1比1搭建部署方案.md
   ↓
5. 拉贝星球项目1比1搭建分步执行方案（精准落地版）.md
   ↓
6. 部署执行检查清单.md
```

### 场景2：快速部署（有经验者）

```
1. README.md（本文档）
   ↓
2. scripts/check-env 检查环境
   ↓
3. 修改 config-params.txt
   ↓
4. scripts/deploy-all 一键部署
   ↓
5. 部署执行检查清单.md 验证
```

---

## 🔧 环境要求

### 必需软件

| 软件 | 版本要求 | 用途 |
|------|---------|------|
| JDK | 1.8 | Java后端运行环境 |
| Maven | 3.5+ | Java项目构建 |
| Node.js | 8.x - 12.x | IM服务器运行环境 |
| MySQL | 5.7+ | 主数据库 |
| Redis | 3.2+ | 缓存数据库 |
| MongoDB | 4.0+ | IM消息存储 |
| PM2 | 最新版 | Node.js进程管理 |
| Nginx | 1.16+ | Web服务器 |

### 可选软件

| 软件 | 版本要求 | 用途 |
|------|---------|------|
| ActiveMQ | 5.15+ | 消息队列 |
| Tomcat | 8.5+ | adminbak部署（可选） |

---

## 📊 技术栈

### 后端

- **adminbak**: Spring MVC 4.1.0 + MyBatis
- **apiservice**: Spring Boot 2.0.1 + Druid + Swagger
- **imsvr**: Koa 2.3.0 + Socket.io 2.3.0 + Express 4.18.2

### 数据库

- **MySQL 5.7**: 主数据库（50+张表）
- **Redis 3.2**: 缓存和会话管理
- **MongoDB 4.0**: IM消息存储

### 前端

- **Vue.js 2.6.11**: H5框架
- **Vant 2.8**: UI组件库
- **Axios**: HTTP客户端

---

## ✅ 部署成功标志

### 服务运行状态

```bash
# 检查所有服务
pm2 list                    # 应显示 3 个 IM 进程
tasklist | findstr java     # 应显示 API 服务
tasklist | findstr nginx    # 应显示 Nginx
```

### 访问测试

- ✅ http://localhost:8080/swagger-ui.html - API文档
- ✅ http://localhost:8080/actuator/health - 健康检查
- ✅ http://localhost:3001 - IM服务
- ✅ http://localhost - H5首页

---

## 🎯 核心功能

### 用户系统
- 用户注册/登录
- 用户信息管理
- 等级系统
- 家族/公会系统

### 房间系统
- 房间创建/管理
- 麦位管理
- 房间推荐
- 公聊大厅

### 礼物系统
- 礼物列表
- 礼物发送
- 礼物墙
- 礼物抽奖

### 充值提现
- 充值产品
- 支付集成（Ping++、微信、支付宝）
- 提现管理

### 排行榜
- 财富榜（日榜/周榜）
- 魅力榜（日榜/周榜）
- 房间榜

### IM通信
- 实时聊天
- 房间消息
- 私聊消息
- 系统通知

---

## 📞 常见问题

### Q1: 环境检查失败怎么办？

**A:** 根据 `check-env` 脚本的提示，安装缺失的组件。详见《1:1搭建部署方案》第2章。

### Q2: 数据库导入失败？

**A:** 
1. 检查 MySQL 密码是否正确
2. 确认 `labei.sql` 文件存在
3. 手动执行：`mysql -uroot -p labei < labei.sql`

### Q3: Maven 编译失败？

**A:**
1. 确认 JDK 版本为 1.8
2. 清理缓存：`mvn clean`
3. 使用阿里云镜像加速

### Q4: 服务启动失败？

**A:**
1. 检查端口是否被占用
2. 查看日志文件
3. 确认配置文件参数正确

### Q5: 如何查看日志？

**A:**
```bash
# API 日志
tail -f apiservice/xchat-web-api/logs/spring.log

# IM 日志
pm2 logs

# Nginx 日志
tail -f /var/log/nginx/error.log
```

---

## 🚀 下一步优化

部署成功后，建议进行以下优化：

### 1. 性能优化
- MySQL 索引优化
- Redis 持久化配置
- JVM 参数调优
- Nginx 缓存配置

### 2. 安全加固
- 数据库安全配置
- Redis 密码和命令重命名
- Nginx 安全头配置
- 应用层安全防护

### 3. 监控配置
- 日志收集（ELK）
- 性能监控（Prometheus + Grafana）
- 告警配置（钉钉/邮件）

### 4. 备份策略
- MySQL 自动备份
- Redis RDB/AOF 备份
- 文件备份
- 灾难恢复方案

详细内容请参考《1:1搭建部署方案》附录部分。

---

## 📝 版本历史

| 版本 | 日期 | 更新内容 |
|------|------|---------|
| v1.0 | 2025-11-10 | 初始版本，包含完整部署文档和脚本 |

---

## 📄 许可证

本文档仅供学习和研究使用。

---

## 🙏 致谢

感谢您使用本部署文档包！

如有任何问题或建议，请查阅相应文档或检查日志文件。

---

**祝您部署顺利！** 🎉

---

## 📌 重要提示

1. **严格按照版本要求安装依赖**（不要使用高版本）
2. **每完成一个步骤，立即验证**
3. **遇到问题及时回退，不要继续下一步**
4. **保存所有验证结果和日志**
5. **最后使用一键脚本测试完整流程**

---

**开始部署：** 请先阅读《部署文档总览.md》

